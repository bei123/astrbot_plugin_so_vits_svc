# So-Vits-SVC API 插件

这是一个用于 AstrBot 的 So-Vits-SVC API 语音转换插件。通过该插件，你可以方便地使用 So-Vits-SVC 的语音转换功能。

## 功能特点

- 支持语音转换（WAV格式）
- 可配置的API服务器地址
- 可自定义默认说话人和音调
- 支持队列管理和超时控制
- 实时状态监控

## 安装方法

1. 确保你已经安装了 AstrBot
2. 将本插件目录复制到 AstrBot 的 `data/plugins` 目录下
3. 重启 AstrBot

## 配置说明

插件配置可以通过 AstrBot 管理面板进行修改，包含以下选项：

### 基础设置
- `base_url`: API服务器地址
  - 默认值: `http://localhost:1145`
  - 说明: 如果是本地部署，可以使用 `http://127.0.0.1:1145`

- `timeout`: 请求超时时间(秒)
  - 默认值: 300
  - 说明: 转换请求的超时时间

### 语音转换设置
- `max_queue_size`: 最大队列大小
  - 默认值: 100
  - 说明: 超过此队列大小将拒绝新的转换请求

- `default_speaker`: 默认说话人ID
  - 默认值: "0"
  - 说明: 默认使用的说话人ID

- `default_pitch`: 默认音调调整
  - 默认值: 0
  - 说明: 默认的音调调整值，范围-12到12

## 使用方法

### 检查服务状态
```
/svc_status
```
显示当前服务状态，包括：
- 服务是否正常运行
- 模型加载状态
- 当前队列大小
- API版本
- API地址
- 默认配置信息

### 转换语音
```
/convert_voice [说话人ID] [音调调整]
```
参数说明：
- `说话人ID`: 可选，不填则使用默认值
- `音调调整`: 可选，范围-12到12，不填则使用默认值

使用示例：
```
/convert_voice 0 0  # 使用说话人0，不调整音调
/convert_voice 1 6  # 使用说话人1，提高6个半音
```

注意：
- 需要同时上传要转换的音频文件（支持WAV或MP3格式）
- 转换过程中会显示进度提示
- 转换完成后会自动发送转换后的音频文件

## 依赖要求

- Python 3.10+
- requests

## 注意事项

1. 使用前请确保 So-Vits-SVC API 服务已正确部署并运行
2. 建议根据服务器性能调整队列大小和超时时间
3. 音频文件会被临时保存在 `data/temp/so-vits-svc` 目录下，转换完成后自动删除

## 问题反馈

如果遇到问题，请检查：
1. API服务是否正常运行（使用 `/svc_status` 检查）
2. 配置参数是否正确
3. 上传的音频文件格式是否支持

## 开源协议

MIT License
